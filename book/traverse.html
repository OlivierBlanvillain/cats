
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Traverse Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.0.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="show.md" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="typeclasses.html">
            
                <a href="typeclasses.html">
            
                    
                    Typeclasses
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="applicative.html">
            
                <a href="applicative.html">
            
                    
                    Applicative
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="apply.html">
            
                <a href="apply.html">
            
                    
                    Apply
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="contravariant.html">
            
                <a href="contravariant.html">
            
                    
                    Contravariant
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="faq.html">
            
                <a href="faq.html">
            
                    
                    Faq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="foldable.html">
            
                <a href="foldable.html">
            
                    
                    Foldable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="functor.html">
            
                <a href="functor.html">
            
                    
                    Functor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="id.html">
            
                <a href="id.html">
            
                    
                    Id
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="invariant.html">
            
                <a href="invariant.html">
            
                    
                    Invariant
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="monad.html">
            
                <a href="monad.html">
            
                    
                    Monad
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="monadcombine.md">
            
                <a href="monadcombine.md">
            
                    
                    Monadcombine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="monadfilter.md">
            
                <a href="monadfilter.md">
            
                    
                    Monadfilter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="monoid.html">
            
                <a href="monoid.html">
            
                    
                    Monoid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="monoidk.md">
            
                <a href="monoidk.md">
            
                    
                    Monoidk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="semigroup.html">
            
                <a href="semigroup.html">
            
                    
                    Semigroup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="semigroupk.html">
            
                <a href="semigroupk.html">
            
                    
                    Semigroupk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="show.md">
            
                <a href="show.md">
            
                    
                    Show
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.17" data-path="traverse.html">
            
                <a href="traverse.html">
            
                    
                    Traverse
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Data Types
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="const.html">
            
                <a href="const.html">
            
                    
                    Const
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="freeapplicative.html">
            
                <a href="freeapplicative.html">
            
                    
                    Freeapplicative
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="freemonad.html">
            
                <a href="freemonad.html">
            
                    
                    Freemonad
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="kleisli.html">
            
                <a href="kleisli.html">
            
                    
                    Kleisli
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="oneand.html">
            
                <a href="oneand.html">
            
                    
                    Oneand
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="optiont.html">
            
                <a href="optiont.html">
            
                    
                    Optiont
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="state.html">
            
                <a href="state.html">
            
                    
                    State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="validated.html">
            
                <a href="validated.html">
            
                    
                    Validated
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="xor.html">
            
                <a href="xor.html">
            
                    
                    Xor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="CONTRIBUTING.html">
            
                <a href="CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="PROCESS.html">
            
                <a href="PROCESS.html">
            
                    
                    Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="AUTHORS.html">
            
                <a href="AUTHORS.html">
            
                    
                    Authors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="CHANGES.html">
            
                <a href="CHANGES.html">
            
                    
                    Changes
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Traverse</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="traverse">Traverse</h1>
<p>In functional programming it is very common to encode &quot;effects&quot; as data types - common effects
include <code>Option</code> for possibly missing values, <code>Xor</code> and <code>Validated</code> for possible errors, and
<code>Future</code> for asynchronous computations.</p>
<p>These effects tend to show up in functions working on a single piece of data - for instance
parsing a single <code>String</code> into an <code>Int</code>, validating a login, or asynchronously fetching website
information for a user.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">import</span> cats.data.<span class="hljs-type">Xor</span>
<span class="hljs-keyword">import</span> scala.concurrent.<span class="hljs-type">Future</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parseInt</span></span>(s: <span class="hljs-type">String</span>): <span class="hljs-type">Option</span>[<span class="hljs-type">Int</span>] = ???

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">SecurityError</span></span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Credentials</span></span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validateLogin</span></span>(cred: <span class="hljs-type">Credentials</span>): <span class="hljs-type">Xor</span>[<span class="hljs-type">SecurityError</span>, <span class="hljs-type">Unit</span>] = ???

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Profile</span></span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">User</span></span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">userInfo</span></span>(user: <span class="hljs-type">User</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">Profile</span>] = ???
</code></pre>
<p>Each function asks only for the data it actually needs; in the case of <code>userInfo</code>, a single <code>User</code>. We
certainly could write one that takes a <code>List[User]</code> and fetch profile for all of them, would be a bit strange.
If we just wanted to fetch the profile of just one user, we would either have to wrap it in a <code>List</code> or write
a separate function that takes in a single user anyways. More fundamentally, functional programming is about
building lots of small, independent pieces and composing them to make larger and larger pieces - does this
hold true in this case?</p>
<p>Given just <code>User =&gt; Future[Profile]</code>, what should we do if we want to fetch profiles for a <code>List[User]</code>?
We could try familiar combinators like <code>map</code>.</p>
<pre><code class="lang-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">profilesFor</span></span>(users: <span class="hljs-type">List</span>[<span class="hljs-type">User</span>]) = users.map(userInfo)
<span class="hljs-comment">// profilesFor: (users: List[User])List[scala.concurrent.Future[Profile]]</span>
</code></pre>
<p>Note the return type <code>List[Future[Profile]]</code>. This makes sense given the type signatures, but seems unwieldy.
We now have a list of asynchronous values, and to work with those values we must then use the combinators on
<code>Future</code> for every single one. It would be nicer instead if we could get the aggregate result in a single
<code>Future</code>, say a <code>Future[List[Profile]]</code>.</p>
<p>As it turns out, the <code>Future</code> companion object has a <code>traverse</code> method on it. However, that method is
specialized to standard library collections and <code>Future</code>s - there exists a much more generalized form
that would allow us to parse a <code>List[String]</code> or validate credentials for a <code>List[User]</code>.</p>
<p>Enter <code>Traverse</code>.</p>
<h2 id="the-type-class">The type class</h2>
<p>At center stage of <code>Traverse</code> is the <code>traverse</code> method.</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Traverse</span>[<span class="hljs-type">F</span>[_]] </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">traverse</span></span>[<span class="hljs-type">G</span>[_] : <span class="hljs-type">Applicative</span>, <span class="hljs-type">A</span>, <span class="hljs-type">B</span>](fa: <span class="hljs-type">F</span>[<span class="hljs-type">A</span>])(f: <span class="hljs-type">A</span> =&gt; <span class="hljs-type">G</span>[<span class="hljs-type">B</span>]): <span class="hljs-type">G</span>[<span class="hljs-type">F</span>[<span class="hljs-type">B</span>]]
}
</code></pre>
<p>In our above example, <code>F</code> is <code>List</code>, and <code>G</code> is <code>Option</code>, <code>Xor</code>, or <code>Future</code>. For the profile example,
<code>traverse</code> says given a <code>List[User]</code> and a function <code>User =&gt; Future[Profile]</code>, it can give you a
<code>Future[List[Profile]]</code>.</p>
<p>Abstracting away the <code>G</code> (still imagining <code>F</code> to be <code>List</code>), <code>traverse</code> says given a collection of data,
and a function that takes a piece of data and returns an effectful value, it will traverse the collection,
applying the function and aggregating the effectful values (in a <code>List</code>) as it goes.</p>
<p>In the most general form, <code>F[_]</code> is some sort of context which may contain a value (or several). While
<code>List</code> tends to be among the most general cases, there also exist <code>Traverse</code> instances for <code>Option</code>,
<code>Xor</code>, and <code>Validated</code> (among others).</p>
<h2 id="choose-your-effect">Choose your effect</h2>
<p>The type signature of <code>Traverse</code> appears highly abstract, and indeed it is - what <code>traverse</code> does as it
walks the <code>F[A]</code> depends on the effect of the function. Let&apos;s see some examples where <code>F</code> is taken to be
<code>List</code>.</p>
<p>Note in the following code snippet we are using <code>traverseU</code> instead of <code>traverse</code>.
<code>traverseU</code> is for all intents and purposes the same as <code>traverse</code>, but with some
<a href="http://typelevel.org/blog/2013/09/11/using-scalaz-Unapply.html" _target="blank">type-level trickery</a>
to allow it to infer the <code>Applicative[Xor[A, ?]]</code> and <code>Applicative[Validated[A, ?]]</code>
instances - <code>scalac</code> has issues inferring the instances for data types that do not
trivially satisfy the <code>F[_]</code> shape required by <code>Applicative</code>.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">import</span> cats.<span class="hljs-type">Semigroup</span>
<span class="hljs-keyword">import</span> cats.data.{<span class="hljs-type">NonEmptyList</span>, <span class="hljs-type">OneAnd</span>, <span class="hljs-type">Validated</span>, <span class="hljs-type">ValidatedNel</span>, <span class="hljs-type">Xor</span>}
<span class="hljs-keyword">import</span> cats.implicits._

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parseIntXor</span></span>(s: <span class="hljs-type">String</span>): <span class="hljs-type">Xor</span>[<span class="hljs-type">NumberFormatException</span>, <span class="hljs-type">Int</span>] =
  <span class="hljs-type">Xor</span>.catchOnly[<span class="hljs-type">NumberFormatException</span>](s.toInt)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parseIntValidated</span></span>(s: <span class="hljs-type">String</span>): <span class="hljs-type">ValidatedNel</span>[<span class="hljs-type">NumberFormatException</span>, <span class="hljs-type">Int</span>] =
  <span class="hljs-type">Validated</span>.catchOnly[<span class="hljs-type">NumberFormatException</span>](s.toInt).toValidatedNel
</code></pre>
<p>Examples.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">val</span> x1 = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>).traverseU(parseIntXor)
<span class="hljs-comment">// x1: cats.data.Xor[NumberFormatException,List[Int]] = Right(List(1, 2, 3))</span>

<span class="hljs-keyword">val</span> x2 = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>).traverseU(parseIntXor)
<span class="hljs-comment">// x2: cats.data.Xor[NumberFormatException,List[Int]] = Left(java.lang.NumberFormatException: For input string: &quot;abc&quot;)</span>

<span class="hljs-keyword">val</span> x3 = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;def&quot;</span>).traverseU(parseIntXor)
<span class="hljs-comment">// x3: cats.data.Xor[NumberFormatException,List[Int]] = Left(java.lang.NumberFormatException: For input string: &quot;abc&quot;)</span>

<span class="hljs-keyword">val</span> v1 = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>).traverseU(parseIntValidated)
<span class="hljs-comment">// v1: cats.data.Validated[cats.data.OneAnd[[+A]List[A],NumberFormatException],List[Int]] = Valid(List(1, 2, 3))</span>

<span class="hljs-keyword">val</span> v2 = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>).traverseU(parseIntValidated)
<span class="hljs-comment">// v2: cats.data.Validated[cats.data.OneAnd[[+A]List[A],NumberFormatException],List[Int]] = Invalid(OneAnd(java.lang.NumberFormatException: For input string: &quot;abc&quot;,List()))</span>

<span class="hljs-keyword">val</span> v3 = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;def&quot;</span>).traverseU(parseIntValidated)
<span class="hljs-comment">// v3: cats.data.Validated[cats.data.OneAnd[[+A]List[A],NumberFormatException],List[Int]] = Invalid(OneAnd(java.lang.NumberFormatException: For input string: &quot;abc&quot;,List(java.lang.NumberFormatException: For input string: &quot;def&quot;)))</span>
</code></pre>
<p>Notice that in the <code>Xor</code> case, should any string fail to parse the entire traversal
is considered a failure. Moreover, once it hits its first bad parse, it will not
attempt to parse any others down the line (similar behavior would be found with
using <code>Option</code> as the effect). Contrast this with <code>Validated</code> where even
if one bad parse is hit, it will continue trying to parse the others, accumulating
any and all errors as it goes. The behavior of traversal is closely tied with the
<code>Applicative</code> behavior of the data type.</p>
<p>Going back to our <code>Future</code> example, we can write an <code>Applicative</code> instance for
<code>Future</code> that runs each <code>Future</code> concurrently. Then when we traverse a <code>List[A]</code>
with an <code>A =&gt; Future[B]</code>, we can imagine the traversal as a scatter-gather.
Each <code>A</code> creates a concurrent computation that will produce a <code>B</code> (the scatter),
and as the <code>Future</code>s complete they will be gathered back into a <code>List</code>.</p>
<h3 id="playing-with-reader">Playing with <code>Reader</code></h3>
<p>Another interesting effect we can use is <code>Reader</code>. Recall that a <code>Reader[E, A]</code> is
a type alias for <code>Kleisli[Id, E, A]</code> which is a wrapper around <code>E =&gt; A</code>.</p>
<p>If we fix <code>E</code> to be some sort of environment or configuration, we can use the
<code>Reader</code> applicative in our traverse.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">import</span> cats.data.<span class="hljs-type">Reader</span>

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Context</span></span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Topic</span></span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Result</span></span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">Job</span>[<span class="hljs-type">A</span>] </span>= <span class="hljs-type">Reader</span>[<span class="hljs-type">Context</span>, <span class="hljs-type">A</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">processTopic</span></span>(topic: <span class="hljs-type">Topic</span>): <span class="hljs-type">Job</span>[<span class="hljs-type">Result</span>] = ???
</code></pre>
<p>We can imagine we have a data pipeline that processes a bunch of data, each piece of data
being categorized by a topic. Given a specific topic, we produce a <code>Job</code> that processes
that topic. (Note that since a <code>Job</code> is just a <code>Reader</code>/<code>Kleisli</code>, one could write many small
<code>Job</code>s and compose them together into one <code>Job</code> that is used/returned by <code>processTopic</code>.)</p>
<p>Corresponding to our bunches of data are bunches of topics, a <code>List[Topic]</code> if you will.
Since <code>Reader</code> has an <code>Applicative</code> instance, we can <code>traverse</code> over this list with <code>processTopic</code>.</p>
<pre><code class="lang-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">processTopics</span></span>(topics: <span class="hljs-type">List</span>[<span class="hljs-type">Topic</span>]) = 
  topics.traverse(processTopic)
</code></pre>
<p>Note the nice return type - <code>Job[List[Result]]</code>. We now have one aggregate <code>Job</code> that when run,
will go through each topic and run the topic-specific job, collecting results as it goes.
We say &quot;when run&quot; because a <code>Job</code> is some function that requires a <code>Context</code> before producing
the value we want.</p>
<p>One example of a &quot;context&quot; can be found in the <a href="http://spark.apache.org/" _target="blank">Spark</a> project. In
Spark, information needed to run a Spark job (where the master node is, memory allocated, etc.)
resides in a <code>SparkContext</code>. Going back to the above example, we can see how one may define
topic-specific Spark jobs (<code>type Job[A] = Reader[SparkContext, A]</code>) and then run several
Spark jobs on a collection of topics via <code>traverse</code>. We then get back a <code>Job[List[Result]]</code>,
which is equivalent to <code>SparkContext =&gt; List[Result]</code>. When finally passed a <code>SparkContext</code>,
we can run the job and get our results back.</p>
<p>Moreover, the fact that our aggregate job is not tied to any specific <code>SparkContext</code> allows us
to pass in a <code>SparkContext</code> pointing to a production cluster, or (using the exact same job) pass
in a test <code>SparkContext</code> that just runs locally across threads. This makes testing our large
job nice and easy.</p>
<p>Finally, this encoding ensures that all the jobs for each topic run on the exact same cluster.
At no point do we manually pass in or thread a <code>SparkContext</code> through - that is taken care for us
by the (applicative) effect of <code>Reader</code> and therefore by <code>traverse</code>.</p>
<h2 id="sequencing">Sequencing</h2>
<p>Sometimes you may find yourself with a collection of data, each of which is already in an effect,
for instance a <code>List[Option[A]]</code>. To make this easier to work with, you want a <code>Option[List[A]]</code>.
Given <code>Option</code> has an <code>Applicative</code> instance, we can traverse over the list with the identity function.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">import</span> cats.implicits._
<span class="hljs-comment">// import cats.implicits._</span>

<span class="hljs-keyword">val</span> l1 = <span class="hljs-type">List</span>(<span class="hljs-type">Option</span>(<span class="hljs-number">1</span>), <span class="hljs-type">Option</span>(<span class="hljs-number">2</span>), <span class="hljs-type">Option</span>(<span class="hljs-number">3</span>)).traverse(identity)
<span class="hljs-comment">// l1: Option[List[Int]] = Some(List(1, 2, 3))</span>

<span class="hljs-keyword">val</span> l2 = <span class="hljs-type">List</span>(<span class="hljs-type">Option</span>(<span class="hljs-number">1</span>), <span class="hljs-type">None</span>, <span class="hljs-type">Option</span>(<span class="hljs-number">3</span>)).traverse(identity)
<span class="hljs-comment">// l2: Option[List[Int]] = None</span>
</code></pre>
<p><code>Traverse</code> provides a convenience method <code>sequence</code> that does exactly this.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">val</span> l1 = <span class="hljs-type">List</span>(<span class="hljs-type">Option</span>(<span class="hljs-number">1</span>), <span class="hljs-type">Option</span>(<span class="hljs-number">2</span>), <span class="hljs-type">Option</span>(<span class="hljs-number">3</span>)).sequence
<span class="hljs-comment">// l1: Option[List[Int]] = Some(List(1, 2, 3))</span>

<span class="hljs-keyword">val</span> l2 = <span class="hljs-type">List</span>(<span class="hljs-type">Option</span>(<span class="hljs-number">1</span>), <span class="hljs-type">None</span>, <span class="hljs-type">Option</span>(<span class="hljs-number">3</span>)).sequence
<span class="hljs-comment">// l2: Option[List[Int]] = None</span>
</code></pre>
<h2 id="traversing-for-effect">Traversing for effect</h2>
<p>Sometimes our effectful functions return a <code>Unit</code> value in cases where there is no interesting value
to return (e.g. writing to some sort of store).</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Data</span></span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">writeToStore</span></span>(data: <span class="hljs-type">Data</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">Unit</span>] = ???
</code></pre>
<p>If we traverse using this, we end up with a funny type.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">import</span> cats.implicits._
<span class="hljs-keyword">import</span> scala.concurrent.<span class="hljs-type">ExecutionContext</span>.<span class="hljs-type">Implicits</span>.global

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">writeManyToStore</span></span>(data: <span class="hljs-type">List</span>[<span class="hljs-type">Data</span>]) =
  data.traverse(writeToStore)
</code></pre>
<p>We end up with a <code>Future[List[Unit]]</code>! A <code>List[Unit]</code> is not of any use to us, and communicates the
same amount of information as a single <code>Unit</code> does.</p>
<p>Traversing solely for the sake of the effect (ignoring any values that may be produced, <code>Unit</code> or otherwise)
is common, so <code>Foldable</code> (superclass of <code>Traverse</code>) provides <code>traverse_</code> and <code>sequence_</code> methods that do the
same thing as <code>traverse</code> and <code>sequence</code> but ignores any value produced along the way, returning <code>Unit</code> at the end.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">import</span> cats.implicits._

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">writeManyToStore</span></span>(data: <span class="hljs-type">List</span>[<span class="hljs-type">Data</span>]) = 
  data.traverse_(writeToStore)

<span class="hljs-comment">// Int values are ignored with traverse_</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">writeToStoreV2</span></span>(data: <span class="hljs-type">Data</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">Int</span>] = 
  ???

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">writeManyToStoreV2</span></span>(data: <span class="hljs-type">List</span>[<span class="hljs-type">Data</span>]) = 
  data.traverse_(writeToStoreV2)
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="show.md" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Show">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"layout":"default","title":"Traverse","section":"typeclasses","source":"core/src/main/scala/cats/Traverse.scala","scaladoc":"#cats.Traverse","level":"1.2.17","depth":2,"next":{"title":"Data Types","level":"1.3","depth":1,"ref":"","articles":[{"title":"Const","level":"1.3.1","depth":2,"path":"const.md","ref":"const.md","articles":[]},{"title":"Freeapplicative","level":"1.3.2","depth":2,"path":"freeapplicative.md","ref":"freeapplicative.md","articles":[]},{"title":"Freemonad","level":"1.3.3","depth":2,"path":"freemonad.md","ref":"freemonad.md","articles":[]},{"title":"Kleisli","level":"1.3.4","depth":2,"path":"kleisli.md","ref":"kleisli.md","articles":[]},{"title":"Oneand","level":"1.3.5","depth":2,"path":"oneand.md","ref":"oneand.md","articles":[]},{"title":"Optiont","level":"1.3.6","depth":2,"path":"optiont.md","ref":"optiont.md","articles":[]},{"title":"State","level":"1.3.7","depth":2,"path":"state.md","ref":"state.md","articles":[]},{"title":"Validated","level":"1.3.8","depth":2,"path":"validated.md","ref":"validated.md","articles":[]},{"title":"Xor","level":"1.3.9","depth":2,"path":"xor.md","ref":"xor.md","articles":[]}]},"previous":{"title":"Show","level":"1.2.16","depth":2,"path":"show.md","ref":"show.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"traverse.md","mtime":"2016-06-18T19:51:22.408Z","type":"markdown"},"gitbook":{"version":"3.0.3","time":"2016-06-18T20:02:33.141Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    

    </body>
</html>

